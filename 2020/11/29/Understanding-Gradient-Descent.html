<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Understanding Gradient Descent | Scott’s Data Science Blog</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Understanding Gradient Descent" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An easy to use blogging platform with support for Jupyter Notebooks." />
<meta property="og:description" content="An easy to use blogging platform with support for Jupyter Notebooks." />
<link rel="canonical" href="https://scottknappnj.github.io/FastPagesBlog/2020/11/29/Understanding-Gradient-Descent.html" />
<meta property="og:url" content="https://scottknappnj.github.io/FastPagesBlog/2020/11/29/Understanding-Gradient-Descent.html" />
<meta property="og:site_name" content="Scott’s Data Science Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-11-29T00:00:00-06:00" />
<script type="application/ld+json">
{"description":"An easy to use blogging platform with support for Jupyter Notebooks.","url":"https://scottknappnj.github.io/FastPagesBlog/2020/11/29/Understanding-Gradient-Descent.html","@type":"BlogPosting","headline":"Understanding Gradient Descent","dateModified":"2020-11-29T00:00:00-06:00","datePublished":"2020-11-29T00:00:00-06:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://scottknappnj.github.io/FastPagesBlog/2020/11/29/Understanding-Gradient-Descent.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/FastPagesBlog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://scottknappnj.github.io/FastPagesBlog/feed.xml" title="Scott's Data Science Blog" /><link rel="shortcut icon" type="image/x-icon" href="/FastPagesBlog/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/FastPagesBlog/">Scott&#39;s Data Science Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/FastPagesBlog/about/">About Me</a><a class="page-link" href="/FastPagesBlog/search/">Search</a><a class="page-link" href="/FastPagesBlog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Understanding Gradient Descent</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-11-29T00:00:00-06:00" itemprop="datePublished">
        Nov 29, 2020
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      6 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/ScottKnappNJ/FastPagesBlog/tree/master/_notebooks/2020-11-29-Understanding-Gradient-Descent.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/FastPagesBlog/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/ScottKnappNJ/FastPagesBlog/master?filepath=_notebooks%2F2020-11-29-Understanding-Gradient-Descent.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/FastPagesBlog/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/ScottKnappNJ/FastPagesBlog/blob/master/_notebooks/2020-11-29-Understanding-Gradient-Descent.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/FastPagesBlog/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-11-29-Understanding-Gradient-Descent.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>pip install -Uqq fastbook
<span class="kn">import</span> <span class="nn">fastbook</span>
<span class="n">fastbook</span><span class="o">.</span><span class="n">setup_book</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastai.vision.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">fastbook</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;image&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In recent years, with the increase in computing speed, increaed access to GPUs (Graphics Processing Unit) and enhanced machine learning libraries, Gradient Descent has become an integral part of many machine learning and deep learning processes, especially those associated with Neural Networks.</p>
<p>We will begin by defining what Gradient Descent is, why it is useful and how it is used in practice.  We will illustrate this with a simple example from the fastai course and book <em>Deep Learning for Coders with fastai and PyTorch</em>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="What-is-Gradient-Descent?">What is Gradient Descent?<a class="anchor-link" href="#What-is-Gradient-Descent?"> </a></h2><p>Let's start by defining what a gradient is.  If you remember back to high school calculus, a derivative of a function calculates the rate of change of that function at a specific point, its' rise over run.  It tells you how much the output changes if you change the inputs a tiny amount.</p>
<p>Well, when you have a bunch of variables in an equation, you will need to know how much the output changes if you change each of these input variables a tiny bit.  This is done by calculating the partial derivatives with respect to each of the variables.  And the gradient is the vector which basically stores all of this information.</p>
<p>Gradient Descent is simply the algorithm that uses this information to update a model's parameters a little at a time improving its' performance.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="A-Simple-Example">A Simple Example<a class="anchor-link" href="#A-Simple-Example"> </a></h2><p>Let's look at an example of the fictional equation of the speed of a roller coaster going over a hill for a period of time, 20.  Using PyTorch's <code>arange</code> method we can create a sequence from 0-19 for this example.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">time</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
<span class="n">time</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12., 13., 14., 15., 16., 17., 18., 19.])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will then simply create a random function which has the speed decreasing to 0 at the midpoint and increasing again after.  We will also add some random noise using <code>randn</code>.  And we will graph what the function looks like.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">speed</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.6</span><span class="o">*</span><span class="p">(</span><span class="n">time</span><span class="o">-</span><span class="mf">9.5</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">speed</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next, we will estimate that the function is a quadratic in the form
$ a t^2 + bt + c$ and we will look to solve for a, b, c.  Let's go ahead on define this function.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">params</span>
    <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">c</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>How will we know if our estimated paramters are good or not?  We need to create a loss function that calculates the error rate of our predictions against the actual data.  In our case, we will use a simple Mean Squared Error loss function.  To calculate this, we simply:</p>
<p>1) Calculate the difference between our predictions and our target values<br />
2) Square the difference<br />
3) Take a mean of the Squared differences.</p>
<p>This is the loss function that we will use our Gradient Descent algorithm to minimize.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">mse</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">preds</span> <span class="o">-</span> <span class="n">target</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Seven-Step-Process">Seven-Step Process<a class="anchor-link" href="#Seven-Step-Process"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, we begin the process of Gradient Descent, which involves seven-steps.</p>
<p>1) Initialize the parameters<br />
2) Calculate the predictions<br />
3) Calculate the loss<br />
4) Calculate the gradients<br />
5) Step the weights<br />
6) Repeat steps 2) through 5)<br />
7) Stop the process</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Step-1:-Initialize-the-Parameters">Step 1: Initialize the Parameters<a class="anchor-link" href="#Step-1:-Initialize-the-Parameters"> </a></h4><p>We begin by setting the initial values for our parameters.  It has been proven that using random initial parameters works as well as any other process, so that's what we will do here utilizing <code>randn</code> again.</p>
<p>We will also add the method <code>.requires_grad_()</code>.  This tells PyTorch to remember the necessary information so that we can later calculate the gradients with respect to these parameters.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">requires_grad_</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Step-2:-Calculate-the-Predictions">Step 2: Calculate the Predictions<a class="anchor-link" href="#Step-2:-Calculate-the-Predictions"> </a></h4><p>In this step, we will calculate the predictions based on our current parameter estimates.  We will also write a quick function to view our targets results along with our current estimates.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preds</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">show_preds</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">speed</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">to_np</span><span class="p">(</span><span class="n">preds</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>  <span class="c1"># to_np() converts a tensor to an array</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">300</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">show_preds</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>These predictions look pretty terrible, but we did just start with random parameters.  Hopefully, our Gradient Descent algorithm will help improve these results</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Step-3:-Calculate-the-loss">Step 3: Calculate the loss<a class="anchor-link" href="#Step-3:-Calculate-the-loss"> </a></h4><p>In this step, we will simply calcualte the loss using our <code>mse</code> function that we previously created.  As you can see from the output, the information for the gradient is also created along with the result.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loss</span> <span class="o">=</span> <span class="n">mse</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">speed</span><span class="p">)</span>
<span class="n">loss</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(24176.3906, grad_fn=&lt;MeanBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Step-4:-Calculate-the-gradients">Step 4: Calculate the gradients<a class="anchor-link" href="#Step-4:-Calculate-the-gradients"> </a></h4><p>In this step, we will calculate the gradients.  And thankfully, we won't have to do this calcuation manually, PyTorch does this all on its' own.  And as you can see from the results, it returns the gradient for each of our parameters.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<span class="n">params</span><span class="o">.</span><span class="n">grad</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([-51698.6758,  -3324.1123,   -243.4835])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Step-5:-Step-the-parameters">Step 5: Step the parameters<a class="anchor-link" href="#Step-5:-Step-the-parameters"> </a></h4><p>Here, we will update the parameters of our model, but how?  From the last step we know how much our loss function will change as we change our parameters, but how much should we adjust them by?  If we adjust our parameters too fast, we run the risk of overshooting our optimal solution and simply bouncing back and forth and never converging to an answer.  If we adjust our parameters too slowly, it will take a long time to converge to an optimal solution.  Additionally, we may be fooled if there are local minimums in the function and if we see the loss going back up, we may interpret that as an incorrect global minimum.</p>
<p>The number that we use as a scalar of the gradients is called the <strong>learning rate</strong>.  There is no answer as to what the correct learning rate is, this can be a tunable parameter in the model, meaning we can try a few different rates and choose the best performing one.  For this purpose, we will set our learning rate to 1e-5.</p>
<p>Another step with we need to do after adjusting the parameters is to zero-out the gradients for our next iteration, as PyTorch we simply add any calculated gradients to the existing ones, which we don't want.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lr</span> <span class="o">=</span> <span class="mf">1e-5</span>
<span class="n">params</span><span class="o">.</span><span class="n">data</span> <span class="o">-=</span> <span class="n">lr</span> <span class="o">*</span> <span class="n">params</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">data</span>
<span class="n">params</span><span class="o">.</span><span class="n">grad</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Step-6:-Repeat-the-process">Step 6: Repeat the process<a class="anchor-link" href="#Step-6:-Repeat-the-process"> </a></h4><p>Here, we will go back to step #2 and #3.  We will make the predictions with our new parameters and calculate the loss and visualize our new predictions.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preds</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
<span class="n">mse</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">speed</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(4919.5947, grad_fn=&lt;MeanBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_preds</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We've improved our Mean Squared Error significantly. Not too bad, for only updating the parameters once.  Let's write a function including everything we've done so far, so we can repeat the process a few more times.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">apply_step</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">prn</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">mse</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">speed</span><span class="p">)</span>
    <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="n">params</span><span class="o">.</span><span class="n">data</span> <span class="o">-=</span> <span class="n">lr</span> <span class="o">*</span> <span class="n">params</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">data</span>
    <span class="n">params</span><span class="o">.</span><span class="n">grad</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">prn</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">preds</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">apply_step</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>4919.5947265625
1275.6175537109375
586.0635986328125
455.57635498046875
430.88177490234375
426.20635986328125
425.319091796875
425.14862060546875
425.114013671875
425.10498046875
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Step-7:-Stop-the-process">Step 7: Stop the process<a class="anchor-link" href="#Step-7:-Stop-the-process"> </a></h4><p>We have decided to stop after an additional 10 epochs arbitrarily.  In practice, we would likely watch the loss function and our metrics to decide when to step.  But here we have seen our Mean Squared Error to a stable amount in only 5-6 epochs.</p>
<ul>
<li>an epoch is the number of times our algorithm works through all of our data.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary"> </a></h2><p>From this simple example, I think you can begin to see the power of using the Gradient Descent algorithm to update model parameters to improve performance.</p>

</div>
</div>
</div>
</div>



  </div><a class="u-url" href="/FastPagesBlog/2020/11/29/Understanding-Gradient-Descent.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/FastPagesBlog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/FastPagesBlog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/FastPagesBlog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>An easy to use blogging platform with support for Jupyter Notebooks.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/ScottKnappNJ" title="ScottKnappNJ"><svg class="svg-icon grey"><use xlink:href="/FastPagesBlog/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/scotknap" title="scotknap"><svg class="svg-icon grey"><use xlink:href="/FastPagesBlog/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
